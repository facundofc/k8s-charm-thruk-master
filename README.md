# Description

[Thruk](https://www.thruk.org/) is a widely used tool which serves the purpose
of aggregating the information generated by several
[Nagios](https://www.nagios.org/) servers into a single application.

It does this by interfacing with another thruk server running alongside each
nagios server. Each of these remote thruks are called "peers" in thruk's
configuration. A peer is just the URL where the remote thruk lives and a couple
of other pieces of info.

This Kubernetes charm, if deployed with the
[meyer91/thruk](https://hub.docker.com/r/meyer91/thruk) image, will create a
pod running said image and automatically start up Thruk. Peers are added by
relating this charm's application with others providing the `thruk-agent`
interface.

# Usage

On `host1`:

    juju deploy nagios --config enable_livestatus=true
    juju deploy thruk-agent
	juju relate nagios thruk-agent

On `host2`:

    juju deploy proxy-thruk-agent thruk-peer-host1 --resource image=alpine \
        --config nagios_context=host1 \
        --config url=http://host1 \
        --config thruk_key=94dlks
    juju deploy thruk-master-k8s --resource image=meyer91/thruk
    juju relate thruk-master-k8s:thruk-agent thruk-peer-host1:thruk-agent

Currently, the
[Nagios](https://charmhub.io/nagios)&nbsp;+&nbsp;[Thruk agent](https://charmhub.io/thruk-agent)
deployment has to be made on a non-kubernetes juju deployment. Neither of
Nagios nor the Thruk agent have charm versions suitable for Kubernetes
deployments yet.

On the contrary, if using this example as is, both the proxy Thruk agent and
the Thruk master itself have to be installed on a Kubernetes juju deployment.
However, there are non-kubernetes versions for [the proxy Thruk
agent](https://charmhub.io/thruk-external-agent) and [the Thruk
master](https://charmhub.io/thruk-master).

Once deployed, Thruk's Web UI will be available on the URL:

    http://host2/thruk/

Username and password are the defaults provided by the `meyer91/thruk` image,
ie. `thrukadmin/thrukadmin`.
